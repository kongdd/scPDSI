<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculate the (sc)PDSI — pdsi • scPDSI</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate the (sc)PDSI — pdsi"><meta property="og:description" content="Calculating the monthly conventional Palmer Drought Severity Index
(PDSI) and Self-calibrating PDSI (scPDSI) using the precipitation
and potential evapotranspiration."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scPDSI</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/Sibada/scPDSI/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate the (sc)PDSI</h1>
    <small class="dont-index">Source: <a href="https://github.com/Sibada/scPDSI/blob/HEAD/R/scpdsi.R" class="external-link"><code>R/scpdsi.R</code></a></small>
    <div class="hidden name"><code>pdsi.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculating the monthly conventional Palmer Drought Severity Index
(PDSI) and Self-calibrating PDSI (scPDSI) using the precipitation
and potential evapotranspiration.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pdsi</span><span class="op">(</span></span>
<span>  <span class="va">P</span>,</span>
<span>  <span class="va">PE</span>,</span>
<span>  AWC <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  start <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  end <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cal_start <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cal_end <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sc <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  num_of_periods <span class="op">=</span> <span class="fl">12</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>P</dt>
<dd><p>Monthly precipitation series without NA <code>[mm]</code>. Can be a time series.</p></dd>


<dt>PE</dt>
<dd><p>Monthly potential evapotranspiration corresponding to the precipitation
series. Can be calculated by the Penman-Monteith or the Thonthwate
equation <code>[mm]</code>.</p></dd>


<dt>AWC</dt>
<dd><p>Available soil water capacity of the soil layer <code>[mm]</code>. Default 100 mm.</p></dd>


<dt>start</dt>
<dd><p>Integer. Start year of the PDSI to be calculate default 1.</p></dd>


<dt>end</dt>
<dd><p>Integer. End year of the PDSI to be calculate.</p></dd>


<dt>cal_start</dt>
<dd><p>Integer. Start year of the calibrate period. Default is start year.</p></dd>


<dt>cal_end</dt>
<dd><p>Integer. End year of the calibrate period. Default is end year.</p></dd>


<dt>sc</dt>
<dd><p>Bool. Should use the self-calibrating procedure to calculate the climatical
coefficient (K2 and duration coefficients). If not it would use the default
parameters of Palmer (1965).</p></dd>


<dt>num_of_periods</dt>
<dd><p>Integer. 12 (for monthly) and 52 (for weekly).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>This function return an object of class <code>pdsi</code>.</p>


<p>The object of class <code>pdsi</code> is a list containing the following components:</p><ul><li><p><code>call</code>: the call to <code>pdsi</code> used to generate the object.</p></li>
<li><p><code>X</code>: time series of the X values, i.e. the Palmer Drought Severity Index (PDSI).</p></li>
<li><p><code>PHDI</code>: time series of the Palmer hydrological drought index (PHDI).</p></li>
<li><p><code>WPLM</code>: time series of the weighted PDSI (WPLM).</p></li>
<li><p><code>inter.vars</code>: An time series matrix containing the intermediate variables,
including <code>P</code> (input precipitation), <code>PE</code> (input potential
evapotranspiration), <code>PR</code> (potential recharge of soil moisture),
<code>PRO</code> (potential runoff), <code>PL</code> (potential loss of soil moisture),
<code>d</code> (water deficiencies), <code>Z</code> (water anomoly index, i.e. Z index),
<code>Prob</code> (probability to end the wet or dry spell), <code>X1</code>, <code>X2</code> and
<code>X3</code> (intermediate variables of calculating the X values).</p></li>
<li><p>clim.coes: a matrix of the climate coefficients including <code>alpha</code>,
<code>beta</code>, <code>gamma</code>, <code>delta</code>, and <code>K1</code> coefficient for each month
in a year.</p></li>
<li><p><code>calib.coes</code>: a matrix of the coefficients in the self-calibrating procedure
of scPDSI, including <code>m</code>, <code>b</code> (slope and intercept of the
duration-accumulated Z index plot), <code>p</code>, <code>q</code> (duration factors), and
<code>K2</code> (ratio to adjust K coefficient) for wet and dry spell, respectively.</p></li>
<li><p><code>calib.coes</code>: a matrix of the coefficients in the self-calibrating procedure
of scPDSI, including <code>m</code>, <code>b</code> (slope and intercept of the
duration-accumulated Z index plot), <code>p</code>, <code>q</code> (duration factors), and
<code>K2</code> (ratio to adjust K coefficient) for wet and dry spell, respectively.
Note that the P and PE would be convered from mm to inch in the calculation,
therefore the units of <code>m</code>, <code>b</code> would also be inch correspondingly.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>The Palmer Drought Severity Index (PDSI), proposed by Palmer (1965), is a
widely used drought indicator to quantify the long-term drought conditions, for
an area at a certain time. The PDSI is a semi-physical based drought index calculated
using the precipitation and potential evapotranspiration data, based on a simple
two-layer bucket water balance model. Conventionally, the constants to calculate
the PDSI were firstly empirically derived by using the meteorological records in
Kansas and Iowa in middle US with a semi-arid climate conditions, therefore the
conventional PDSI usually could not satisfactorily represent the drought conditions
for other areas around the world, which also makes spatial comparisons of PDSI values
difficult.</p>
<p>For this, Wells et al. (2004) proposed a self-calibrating Palmer Drought Severity
Index (scPDSI). The scPDSI could automatically adjust the empirical constants
in the PDSI computation with dynamically calculated values. Several works have
proved that the scPDSI performs better in spatially comparison than the conventional
PDSI. For more details please see the works of Wells et al. (2004).</p>
<p>This function could also calculate the conventional PDSI with revised constants.
Before the scPDSI appeared, the PDSI calculation has also been revised focusing
on the local climate characteristics in many area around the world. Those
constants could be reset by using the global options before calculating the PDSI
e.g.:</p>
<div class="sourceCode"><pre><code><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>PDSI.coe.K1.1 <span class="op">=</span> <span class="fl">1.6</span><span class="op">)</span></span></code></pre></div>

<p>And calculation in the PDSI would be:
$$Ki0=coeK11 * lg(((PEi+Ri+ROi)/(Pi+Li)+coeK12)/Di)+coeK13$$
$$Ki=coeK2/(\sum Dj*Kj) * Ki$$
$$X[i]=p*X[i-1]+q*Z[i]$$</p>
<p>\(coeK11\), \(coeK12\), \(coeK13\), \(coeK2\), \(p\), and \(q\) are
corresponding to <code>PDSI.coe.K1.1</code>, <code>PDSI.coe.K1.2</code>, <code>PDSI.coe.K1.3</code>,
<code>PDSI.coe.K2</code>, <code>PDSI.p</code>, and <code>PDSI.q</code>, respectively.</p>
<p>For example, in a national standard in China about meteorological drought level
(GB/T 20481-2017), the PDSI was revised by re-adjust the constants in the
calculation. To use the PDSI based on this standard should set the global
options of R as follows:</p>
<div class="sourceCode"><pre><code><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>PDSI.coe.K1.1 <span class="op">=</span> <span class="fl">1.6</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>PDSI.coe.K1.3 <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>PDSI.coe.K2 <span class="op">=</span> <span class="fl">16.84</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>PDSI.p <span class="op">=</span> <span class="fl">0.755</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>PDSI.q <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">1.63</span><span class="op">)</span></span></code></pre></div>

    </div>
    <div id="references">
    <h2>References</h2>
    <p>Palmer W., 1965. Meteorological drought. U.s.department of Commerce
Weather Bureau Research Paper.</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>        Wells, N., Goddard, S., Hayes, M. J., <span class="fl">2004.</span> A Self<span class="sc">-</span>Calibrating Palmer</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>        Drought Severity Index. Journal of Climate, <span class="dv">17</span>(<span class="dv">12</span>)<span class="sc">:</span><span class="dv">2335</span><span class="fl">-2351.</span></span></code></pre><p></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Sibada/scPDSI" class="external-link">scPDSI</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="Datasets.html">data</a></span><span class="op">(</span><span class="va">Lubuge</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">P</span> <span class="op">&lt;-</span> <span class="va">Lubuge</span><span class="op">$</span><span class="va">P</span></span></span>
<span class="r-in"><span><span class="va">PE</span> <span class="op">&lt;-</span> <span class="va">Lubuge</span><span class="op">$</span><span class="va">PE</span></span></span>
<span class="r-in"><span><span class="va">sc_pdsi</span> <span class="op">&lt;-</span> <span class="fu">pdsi</span><span class="op">(</span><span class="va">P</span>, <span class="va">PE</span>, start <span class="op">=</span> <span class="fl">1960</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sc_pdsi</span><span class="op">)</span> <span class="co"># plot PDSI</span></span></span>
<span class="r-plt img"><img src="pdsi-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sc_pdsi</span>, index <span class="op">=</span> <span class="st">"PHDI"</span><span class="op">)</span> <span class="co"># plot PHDI</span></span></span>
<span class="r-plt img"><img src="pdsi-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sc_pdsi</span>, index <span class="op">=</span> <span class="st">"WPLM"</span><span class="op">)</span> <span class="co"># plot weighted PDSI</span></span></span>
<span class="r-plt img"><img src="pdsi-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Without self-calibrating.</span></span></span>
<span class="r-in"><span><span class="va">ori_pdsi</span> <span class="op">&lt;-</span> <span class="fu">pdsi</span><span class="op">(</span><span class="va">P</span>, <span class="va">PE</span>, start <span class="op">=</span> <span class="fl">1960</span>, sc <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ori_pdsi</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="pdsi-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Without self-calibrating and use standards of</span></span></span>
<span class="r-in"><span><span class="co"># mainland China. (GB/T 20481-2017)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   PDSI.coe.K1.1 <span class="op">=</span> <span class="fl">1.6</span>,</span></span>
<span class="r-in"><span>   PDSI.coe.K1.3 <span class="op">=</span> <span class="fl">0.4</span>,</span></span>
<span class="r-in"><span>   PDSI.coe.K2   <span class="op">=</span> <span class="fl">16.84</span>,</span></span>
<span class="r-in"><span>   PDSI.p        <span class="op">=</span> <span class="fl">0.755</span>,</span></span>
<span class="r-in"><span>   PDSI.q        <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">1.63</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gb_pdsi</span> <span class="op">&lt;-</span> <span class="fu">pdsi</span><span class="op">(</span><span class="va">P</span>, <span class="va">PE</span>, start <span class="op">=</span> <span class="fl">1960</span>, sc <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gb_pdsi</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="pdsi-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Ruida Zhong, Dongdong Kong, Xiaohong Chen, Zhaoli Wang, Chengguang Lai.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

